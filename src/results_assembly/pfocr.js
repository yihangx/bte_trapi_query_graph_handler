const debug = require('debug')('bte:biothings-explorer-trapi:Score');
const axios = require('axios');

const _ = require('lodash');
const gene = ["NCBIGene:57486", "NCBIGene:2309", "NCBIGene:5013", "NCBIGene:5144", "NCBIGene:10181", "NCBIGene:326625", "NCBIGene:8743", "NCBIGene:84273", "NCBIGene:2034", "NCBIGene:2064", "NCBIGene:2099", "NCBIGene:1051", "NCBIGene:5689", "NCBIGene:57001", "NCBIGene:1788", "NCBIGene:4729", "NCBIGene:54205", "NCBIGene:84525", "NCBIGene:4004", "NCBIGene:10481", "NCBIGene:1514", "NCBIGene:10038", "NCBIGene:7001", "NCBIGene:605", "NCBIGene:22905", "NCBIGene:3178", "NCBIGene:312", "NCBIGene:26995", "NCBIGene:10128", "NCBIGene:4289", "NCBIGene:3992", "NCBIGene:23512", "NCBIGene:4286", "NCBIGene:5950", "NCBIGene:2697", "NCBIGene:3485", "NCBIGene:2026", "NCBIGene:28966", "NCBIGene:5175", "NCBIGene:5894", "NCBIGene:3622", "NCBIGene:406", "NCBIGene:26054", "NCBIGene:5428", "NCBIGene:652", "NCBIGene:3304", "NCBIGene:4436", "NCBIGene:514", "NCBIGene:7481", "NCBIGene:3398", "NCBIGene:54541", "NCBIGene:79923", "NCBIGene:7431", "NCBIGene:8508", "NCBIGene:2683", "NCBIGene:650", "NCBIGene:25984", "NCBIGene:80232", "NCBIGene:64927", "NCBIGene:11011", "NCBIGene:6256", "NCBIGene:11162", "NCBIGene:3033", "NCBIGene:489", "NCBIGene:22941", "NCBIGene:100507679", "NCBIGene:23327", "NCBIGene:1956", "NCBIGene:6310", "NCBIGene:4967", "NCBIGene:10498", "NCBIGene:2170", "NCBIGene:3336", "NCBIGene:54534", "NCBIGene:1020", "NCBIGene:5424", "NCBIGene:3856", "NCBIGene:64781", "NCBIGene:5163", "NCBIGene:1317", "NCBIGene:3880", "NCBIGene:2194", "NCBIGene:6643", "NCBIGene:6453", "NCBIGene:861", "NCBIGene:1386", "NCBIGene:7849", "NCBIGene:4050", "NCBIGene:64710", "NCBIGene:36", "NCBIGene:947", "NCBIGene:2314", "NCBIGene:4860", "NCBIGene:781", "NCBIGene:55323", "NCBIGene:64147", "NCBIGene:23231", "NCBIGene:688", "NCBIGene:6657", "NCBIGene:9518", "NCBIGene:3868", "NCBIGene:2078", "NCBIGene:5599", "NCBIGene:5465", "NCBIGene:3958", "NCBIGene:5327", "NCBIGene:51696", "NCBIGene:23522", "NCBIGene:6795", "NCBIGene:1891", "NCBIGene:9204", "NCBIGene:2639", "NCBIGene:29088", "NCBIGene:28514", "NCBIGene:1879", "NCBIGene:10236", "NCBIGene:3146", "NCBIGene:7080", "NCBIGene:4285", "NCBIGene:23314", "NCBIGene:23670", "NCBIGene:112487", "NCBIGene:3569", "NCBIGene:9586", "NCBIGene:7718", "NCBIGene:163050", "NCBIGene:1045", "NCBIGene:389421", "NCBIGene:56052", "NCBIGene:10855", "NCBIGene:91373", "NCBIGene:1490", "NCBIGene:3558", "NCBIGene:51310", "NCBIGene:51343", "NCBIGene:9054", "NCBIGene:23067", "NCBIGene:6908", "NCBIGene:1113", "NCBIGene:7923", "NCBIGene:7088", "NCBIGene:3313", "NCBIGene:6616", "NCBIGene:3691", "NCBIGene:55008", "NCBIGene:9966", "NCBIGene:11118", "NCBIGene:10891", "NCBIGene:375449", "NCBIGene:201266", "NCBIGene:6337", "NCBIGene:285367", "NCBIGene:3162", "NCBIGene:5927", "NCBIGene:6277", "NCBIGene:6696", "NCBIGene:4343", "NCBIGene:207", "NCBIGene:3170", "NCBIGene:347902", "NCBIGene:3855", "NCBIGene:3383", "NCBIGene:1975", "NCBIGene:3303", "NCBIGene:92609", "NCBIGene:3198", "NCBIGene:23464", "NCBIGene:26136", "NCBIGene:7450", "NCBIGene:2303", "NCBIGene:3135", "NCBIGene:3486", "NCBIGene:10988", "NCBIGene:335", "NCBIGene:6623", "NCBIGene:4087", "NCBIGene:2116", "NCBIGene:5111", "NCBIGene:217", "NCBIGene:836", "NCBIGene:6714", "NCBIGene:2224", "NCBIGene:3861", "NCBIGene:84816", "NCBIGene:8202", "NCBIGene:133522", "NCBIGene:1728", "NCBIGene:7108", "NCBIGene:29126", "NCBIGene:6434", "NCBIGene:2719", "NCBIGene:7124", "NCBIGene:57713", "NCBIGene:5493", "NCBIGene:1843", "NCBIGene:7270", "NCBIGene:7280", "NCBIGene:27316", "NCBIGene:8626", "NCBIGene:7390", "NCBIGene:5922", "NCBIGene:3212", "NCBIGene:90806", "NCBIGene:388", "NCBIGene:7157", "NCBIGene:174", "NCBIGene:59", "NCBIGene:7316", "NCBIGene:2628", "NCBIGene:794", "NCBIGene:55655", "NCBIGene:1080", "NCBIGene:3988", "NCBIGene:23028", "NCBIGene:23657", "NCBIGene:115201", "NCBIGene:7083", "NCBIGene:8050", "NCBIGene:2990", "NCBIGene:4154", "NCBIGene:79718", "NCBIGene:388610", "NCBIGene:92399", "NCBIGene:4092", "NCBIGene:639", "NCBIGene:4513", "NCBIGene:1026", "NCBIGene:182", "NCBIGene:10450", "NCBIGene:210", "NCBIGene:2660", "NCBIGene:10161", "NCBIGene:51540", "NCBIGene:3866", "NCBIGene:79772", "NCBIGene:2203", "NCBIGene:2167", "NCBIGene:4005", "NCBIGene:4684", "NCBIGene:7113", "NCBIGene:57721", "NCBIGene:4200", "NCBIGene:64976", "NCBIGene:11083", "NCBIGene:10102", "NCBIGene:3251", "NCBIGene:93010", "NCBIGene:7980", "NCBIGene:3566", "NCBIGene:6742", "NCBIGene:9402", "NCBIGene:5460", "NCBIGene:1371", "NCBIGene:2735", "NCBIGene:1543", "NCBIGene:3169", "NCBIGene:2954", "NCBIGene:8091", "NCBIGene:10763", "NCBIGene:2744", "NCBIGene:26137", "NCBIGene:8573", "NCBIGene:5357", "NCBIGene:2313", "NCBIGene:673", "NCBIGene:4638", "NCBIGene:56956", "NCBIGene:2936", "NCBIGene:10969", "NCBIGene:4582", "NCBIGene:1875", "NCBIGene:8678", "NCBIGene:4089", "NCBIGene:7076", "NCBIGene:342574", "NCBIGene:25898", "NCBIGene:1407", "NCBIGene:85236", "NCBIGene:3920", "NCBIGene:1959", "NCBIGene:1759", "NCBIGene:5829", "NCBIGene:23242", "NCBIGene:3172", "NCBIGene:5629", "NCBIGene:84263", "NCBIGene:51268", "NCBIGene:9429", "NCBIGene:63898", "NCBIGene:1044", "NCBIGene:2169", "NCBIGene:6670", "NCBIGene:5142", "NCBIGene:8870", "NCBIGene:10486", "NCBIGene:80205", "NCBIGene:205", "NCBIGene:9854", "NCBIGene:221935", "NCBIGene:328", "NCBIGene:387119", "NCBIGene:6662", "NCBIGene:2305", "NCBIGene:175", "NCBIGene:3630", "NCBIGene:96764", "NCBIGene:211", "NCBIGene:1540", "NCBIGene:54556", "NCBIGene:3624", "NCBIGene:4015", "NCBIGene:3713", "NCBIGene:10632", "NCBIGene:25805", "NCBIGene:25942", "NCBIGene:221143", "NCBIGene:4585", "NCBIGene:10999", "NCBIGene:231", "NCBIGene:7994", "NCBIGene:6382", "NCBIGene:34", "NCBIGene:80310", "NCBIGene:6855", "NCBIGene:3956", "NCBIGene:1387", "NCBIGene:7846", "NCBIGene:4023"]

const geneSize = gene.length;
const maxGeneSize = 100;
const multpleResponse = [];

async function getPfocr(gene) {
  const lowerGene = gene.map(element => {
    return element.toLowerCase();
  });
  const query = "q=associatedWith.mentions.genes." + lowerGene.join(' OR associatedWith.mentions.genes.');
  const url = 'https://biothings.ncats.io/pfocr/query?';
  const response = axios.get(url + query + "&fetch_all=true");
  return response
    .then(result => { console.log(JSON.stringify(result['data'])); return JSON.stringify(result['data']); })
    .catch(error => { console.error(error); return Promise.reject(error); });
}

if (geneSize <= maxGeneSize) {
  getPfocr(gene);
} else {
  for (let i = 0; i < geneSize; i += maxGeneSize) {
    const chunk = gene.slice(i, i + maxGeneSize);
    multpleResponse.push(getPfocr(chunk));
}
}
module.exports.getPfocr = getPfocr;
